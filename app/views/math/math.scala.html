@(r: play.mvc.Http.Request, u: utils.Utils, page_settings: utils.app.page.PageSettings, redirect: String, sum: models.db.math.Sum)

@base.body(r, u, u.l.l(r, "math.title.calculator"), page_settings) { } {
<div class="container-fluid">
    <h1>@u.l.l(r, "math.title.calculator")</h1>
    <form class="validate-form mb-3">
        <div class="page">
            <div class="row">
                <div class="mb-3 column">
                    <label for="number-one">@u.l.l(r, "math.label.number_one")</label>
                    <input aria-describedby="number-one" aria-label='@u.l.l(r, "math.label.number_one")' autofocus
                           class="form-control validate-not-empty validate-blur validate-no-valid-feedback"
                           data-invalid-feedback='@u.l.l(r, "math.text.number_cannot_be_empty")'
                           id="number-one"
                           name="number-one"
                           placeholder='@u.l.l(r, "math.label.number_one")'
                           step="1" type="number" value="@if(sum!=null) {@sum.getNumberOne()} else {100}">
                    <label for="number-two">@u.l.l(r, "math.label.number_two")</label>
                    <input aria-describedby="number-two" aria-label='@u.l.l(r, "math.label.number_two")'
                           class="form-control validate-not-empty validate-blur validate-no-valid-feedback"
                           data-invalid-feedback='@u.l.l(r, "math.text.number_cannot_be_empty")'
                           id="number-two"
                           name="number-two"
                           placeholder='@u.l.l(r, "math.label.number_two")'
                           step="1"
                           type="number" value="@if(sum != null) {@sum.getNumberTwo().toInt} else{10}">
                </div>
                <div class="mb-3 column">
                    <label for="compare-result">@u.l.l(r, "math.label.result")</label>
                    <input aria-describedby="result" aria-label='@u.l.l(r, "math.label.result")' class="form-control"
                           id="tvInput"
                           readonly type="text" value='@if(sum != null) {@sum.getResult()}'>
                </div>
            </div>
            <div class="mb-2">
                <button class="btn btn-success" onclick="setResult()" type="button"><i class="fa fa-sign-in">
                </i> @u.l.l(r,
                    "math.label.sum")
                </button>
            </div>
            <div id="app">
                <math-history :caption="caption" :items="items"></math-history>
            </div>
        </div>
    </form>
</div>
} {
@base.vue_dependency()

<script src='@controllers.routes.Assets.versioned("javascripts/vue/components/math.js")' type="text/javascript"></script>

<script type="text/javascript">

		var app = new Vue({
		  	el: '#app',
		  	data: {
		  		caption: '@u.l.l(r, "math.caption.results")',
                items: []
		  	},
		});

        function setResult(){
        let numberOne = document.getElementById("number-one").value;
        let numberTwo = document.getElementById("number-two").value;
             jsRoutes.controllers.MathController.ajaxSubmitCompareNumber(numberOne, numberTwo).ajax().done(function(data){
             var s = document.getElementById("tvInput");
              s.value = data.data.result;
              loadSumData();
             });
        }

		function loadSumData(){
			jsRoutes.controllers.MathController.ajaxGetSumData().ajax().done(function(data){
				if(data && data.data && Array.isArray(data.data)){
					app.items = data.data;
				}else {
					showDialog('danger', messages('error.label.unexpected_error'), messages("general.text.operation_error"));
				}
			}).fail(function(jqxhr){
				try{
					console.log(jqxhr.responseText);
					var data = JSON.parse(jqxhr.responseText);
					if(data && data.error_message){
						showDialog('danger', messages('error.label.unexpected_error'), data.error_message);
					}
				}catch(err) {
					console.error(err);
					showDialog('danger', messages('error.label.unexpected_error'), messages("general.text.operation_error"));
				}
			});
		}


		$(document).ready(function(){
			loadSumData();
		});
</script>
}
